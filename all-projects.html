<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>All DIY Projects</title>
    <link rel="stylesheet" href="css/style.css" />
</head>
<body>

    <!-- Navbar -->
    <nav class="navbar">
        <div class="navbar-container">
            <a href="index.html" class="logo">DIY Project Hub</a>
            <button class="menu-toggle" onclick="toggleNav()">☰</button>
            <ul class="nav-links" id="navLinks">
                <li><a href="index.html">Home</a></li>
                <li><a href="all-projects.html">Projects</a></li>
                <li><a href="tool-packages.html">Tool Packages</a></li>
                <li><a href="help.html">Help</a></li>
                <li><a href="login.html">Login</a></li>
            </ul>
        </div>
    </nav>

    <main class="project-directory">
        <h1>All Projects</h1>

        <!-- Search Bar and Filter Tags (modular insert) -->
        <div id="projectSearchBar"></div>

        <section class="project-grid">

            <!-- Project Card 1 -->
            <a href="projects/garden-bed.html"
               class="project-card"
               data-title="raised garden bed"
               data-category="beginner"
               data-tags="outdoor,woodworking">
                <img src="images/garden-bed.jpg" alt="Raised Garden Bed" />
                <div class="card-content">
                    <h2>Raised Garden Bed</h2>
                    <p>Beginner | 2–3 hrs</p>
                </div>
            </a>

            <!-- Project Card 2 -->
            <a href="projects/firepit.html"
               class="project-card"
               data-title="backyard fire pit"
               data-category="intermediate"
               data-tags="outdoor,woodworking">
                <img src="images/firepit.jpg" alt="Backyard Fire Pit">
                <div class="card-content">
                    <h2>Backyard Fire Pit</h2>
                    <p>Intermediate | 4–5 hrs</p>
                </div>
            </a>

        </section>
    </main>

    <footer>
        <p>&copy; 2025 DIY Project Hub</p>
    </footer>

    <!-- Toggle navbar -->
    <script>
        function toggleNav() {
            const nav = document.getElementById("navLinks");
            nav.classList.toggle("show");
        }

        window.addEventListener("click", function (event) {
            const menu = document.getElementById("navLinks");
            const toggleButton = document.querySelector(".menu-toggle");

            if (!menu.contains(event.target) && !toggleButton.contains(event.target)) {
                menu.classList.remove("show");
            }
        });
    </script>

    <!-- Search/Filter logic -->
    <script type="module">
        import { setupProjectRedirectFilters } from "./js/search-router.js";

        window.addEventListener("DOMContentLoaded", () => {
            setupProjectRedirectFilters();

            const urlParams = new URLSearchParams(window.location.search);
            const searchTerm = urlParams.get("search") || "";
            const selectedTag = urlParams.get("tag") || "all";
            const selectedCategory = urlParams.get("category") || "all";

            const cards = document.querySelectorAll(".project-card");

            function filterProjects() {
                cards.forEach(card => {
                    const title = card.dataset.title || "";
                    const cat = card.dataset.category || "";
                    const tags = (card.dataset.tags || "").split(",");

                    const matchesSearch = title.includes(searchTerm.toLowerCase());
                    const matchesCategory = selectedCategory === "all" || cat === selectedCategory;
                    const matchesTag = selectedTag === "all" || tags.includes(selectedTag);

                    card.style.display = (matchesSearch && matchesCategory && matchesTag) ? "block" : "none";
                });
            }

            filterProjects();
        });
    </script>

</body>
</html>