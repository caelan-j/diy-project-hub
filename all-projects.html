<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>All DIY Projects</title>
    <link rel="stylesheet" href="css/style.css" />
</head>
<body>

    <!-- Navbar -->
    <div id="navbar"></div>

    <main class="project-directory">
        <h1>All Projects</h1>

        <!-- Search Bar and Filter Tags (modular insert) -->
        <div id="projectSearchBar"></div>

        <section class="project-grid">

            <!-- Project Card 1 -->
            <a href="projects/garden-bed.html"
               class="project-card"
               data-title="raised garden bed"
               data-category="beginner"
               data-tags="outdoor,woodworking">
                <img src="images/garden-bed.jpg" alt="Raised Garden Bed" />
                <div class="card-content">
                    <h2>Raised Garden Bed</h2>
                    <p>Beginner | 2–3 hrs</p>
                </div>
            </a>

            <!-- Project Card 2 -->
            <a href="projects/firepit.html"
               class="project-card"
               data-title="backyard fire pit"
               data-category="intermediate"
               data-tags="outdoor,woodworking">
                <img src="images/firepit.jpg" alt="Backyard Fire Pit">
                <div class="card-content">
                    <h2>Backyard Fire Pit</h2>
                    <p>Intermediate | 4–5 hrs</p>
                </div>
            </a>

        </section>
    </main>

    <!-- Footer -->
    <div id="footer"></div>

    <!-- Java for layout -->
    <script type="module">
        import { loadLayout } from "./js/load-layout.js";
        loadLayout();
    </script>

    <!-- Search/Filter logic -->
    <script type="module">
        import { setupProjectRedirectFilters } from "./js/search-router.js";

        window.addEventListener("DOMContentLoaded", () => {
            setupProjectRedirectFilters();

            const urlParams = new URLSearchParams(window.location.search);
            const searchTerm = urlParams.get("search") || "";
            const selectedTag = urlParams.get("tag") || "all";
            const selectedCategory = urlParams.get("category") || "all";

            const cards = document.querySelectorAll(".project-card");

            function filterProjects() {
                cards.forEach(card => {
                    const title = card.dataset.title || "";
                    const cat = card.dataset.category || "";
                    const tags = (card.dataset.tags || "").split(",");

                    const matchesSearch = title.includes(searchTerm.toLowerCase());
                    const matchesCategory = selectedCategory === "all" || cat === selectedCategory;
                    const matchesTag = selectedTag === "all" || tags.includes(selectedTag);

                    card.style.display = (matchesSearch && matchesCategory && matchesTag) ? "block" : "none";
                });
            }

            filterProjects();
        });
    </script>

</body>
</html>